(this["webpackJsonpmatytermind-frontend"]=this["webpackJsonpmatytermind-frontend"]||[]).push([[0],[,,,,function(e,n,t){},function(e,n,t){},,function(e,n,t){e.exports=t(21)},,,,,function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var r=t(0),s=t.n(r),a=t(6),o=t.n(a),i=(t(12),t(13),t(2)),u=t(1),c={pins:4,colours:6,lines:10},l=Array.from({length:c.pins},(function(){return-1})),m={id:"",settings:c,actualGuess:l.map((function(e){return e})),actualLine:0,changeGuess:function(e){m.actualGuess=e},nextLine:function(){m.actualLine++,m.actualGuess=l.map((function(e){return e}))},setId:function(e){m.id=e}},d=s.a.createContext(m);t(14),t(15);function f(){window.location.reload()}var p=s.a.memo((function(e){var n=e.playerWon,t=e.lessLine,r=e.error,a=e.isLoaded;return s.a.createElement("div",{className:"header"},r&&"".concat(r.message),!a&&"Loading...",n&&s.a.createElement("div",{className:"button",onClick:function(){return f()}},"Congratulations! ",s.a.createElement("br",null),"You won!",s.a.createElement("br",null),"Do you want to play again?"),!n&&!t&&s.a.createElement("div",{className:"button",onClick:function(){return f()}},"You lost :( ",s.a.createElement("br",null),"Do you want to try again?"))}),(function(e,n){return e.playerWon===n.playerWon&&e.lessLine===n.lessLine&&e.isLoaded===n.isLoaded&&e.error===n.error})),g=(t(16),s.a.memo((function(){return s.a.createElement("footer",null,s.a.createElement("p",null,"Free logic game based on ",s.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Mastermind_(board_game)"},"Mastermind"),"."),s.a.createElement("p",null,"Implemented by ",s.a.createElement("a",{href:"http://budavariam.github.io"},"M\xe1ty\xe1s Budav\xe1ri")))}),(function(){return!0}))),v=(t(17),t(4),s.a.memo((function(e){return s.a.createElement("div",{className:"pin smallpin smallpin-".concat(e.pinId)})}),(function(e,n){return e.pinId===n.pinId}))),E=(t(5),t(18),s.a.memo((function(e){return s.a.createElement("div",{className:"pin hugepin hugepin-".concat(e.pinId," ").concat(e.marked?"marked":""),onClick:e.onClick})}),(function(e,n){return e.pinId===n.pinId}))),h=(t(19),function(e){var n=Object(r.useState)({pinId:e.pinId}),t=Object(u.a)(n,2),a=t[0],o=t[1];return s.a.createElement(d.Consumer,null,(function(n){var t=n.actualGuess,r=n.changeGuess,i=n.settings;return s.a.createElement("details",{open:e.open,onClick:function(n){e.changeSelector(e.pinIndex),n.preventDefault()}},s.a.createElement("summary",null,s.a.createElement(E,{pinId:a.pinId})),s.a.createElement("div",{className:"pinselector"},Array.from({length:i.colours}).map((function(n,i){return s.a.createElement(E,{key:"".concat(e.pinId,"-").concat(i),pinId:i,marked:i===a.pinId,onClick:function(){return function(n,t,r){o({pinId:n}),t[e.pinIndex]=n,r(t)}(i,t,r)}})}))))}))}),y=function(e){var n=Object(r.useState)({openedSelectorNr:-1}),t=Object(u.a)(n,2),a=t[0],o=t[1];return s.a.createElement("div",{className:"guess"},e.actual?e.pins.map((function(e,n){return s.a.createElement(h,{pinId:e,key:"actual-".concat(n),pinIndex:n,open:a.openedSelectorNr===n,changeSelector:function(e){o((function(n){return{openedSelectorNr:e!==n.openedSelectorNr?e:-1}}))}})})):e.pins.map((function(e,n){return s.a.createElement(E,{pinId:e,key:"".concat(n,"-").concat(e)})})))},I=s.a.memo((function(e){return s.a.createElement("div",{className:"line ".concat(e.actual?"actual":"")},s.a.createElement(y,{actual:e.actual,pins:e.pins}),s.a.createElement("div",{className:"results"},e.actual?s.a.createElement("div",{className:"submit"},e.submitInProgress?s.a.createElement("div",{className:"spinner"}):s.a.createElement("div",{className:"button",onClick:function(){return e.submitGuess()}},"OK")):s.a.createElement("div",{className:"sent"},e.results.map((function(e,n){return s.a.createElement(v,{pinId:e,key:"".concat(n,"-").concat(e)})})))))}),(function(e,n){var t=n.results.every((function(e){return 0===e}))&&n.pins.every((function(e){return-1===e})),r=e.results===n.results&&e.pins===n.pins;return n.actual?r&&e.submitInProgress===n.submitInProgress:r||t})),b=(t(20),s.a.memo((function(e){return s.a.createElement("div",{className:"line"},s.a.createElement("div",{className:"solution ".concat(e.isOver?"":"hidden-solution")},s.a.createElement(y,{pins:e.solution?e.solution:l.map((function(e){return e})),actual:!1})),s.a.createElement("div",{className:"results"}))}),(function(e,n){return e.isOver===n.isOver}))),L=function(e){var n=e.lines.map((function(n,t){return s.a.createElement(I,{key:t,pins:n.guess,results:n.result,actual:!e.isOver&&t===e.actualLine,submitInProgress:e.submitInProgress,submitGuess:e.submitGuess})}));return s.a.createElement("div",{className:"playarea"},s.a.createElement(b,{isOver:e.isOver,solution:e.solution}),n)};function N(e){return Array.from({length:e.pins},(function(){return Math.floor(Math.random()*e.colours)}))}var O={serverless:{secret:[-1,-1,-1,-1],guesses:[],isOver:!1}},w={colours:6,pins:4,lines:10};var P=function(){var e=Object(r.useContext)(d),n=Object(r.useReducer)((function(e,n){return Object(i.a)(Object(i.a)({},e),n)}),{error:null,isLoaded:!1,submitInProgress:!1,lines:function(e){var n={guess:l.map((function(e){return e})),result:Array.from({length:e.pins},(function(){return 0}))};return Array.from({length:e.lines},(function(){return n}))}(c),playerWon:!1,solution:null}),t=Object(u.a)(n,2),a=t[0],o=t[1];Object(r.useEffect)((function(){(function(){var e="serverless";return O[e]={secret:N(w),guesses:[],isOver:!1},Promise.resolve({id:e,settings:w})})().then((function(n){e.setId(n.id),o({type:"LOADED",isLoaded:!0})}),(function(e){console.error(e),o({type:"LOADED",isLoaded:!0,error:{message:"There was an error during server request, sorry for the inconvenience :("}})}))}),[]);var m=function(n,t){for(var r=[],s=0;s<t.goodGuess;s++)r.push(1);for(var a=0;a<t.goodColour;a++)r.push(2);for(;r.length<e.settings.pins;)r.push(0);return n[e.actualLine]={guess:e.actualGuess.map((function(e){return e})),result:r},e.nextLine(),n},f=a.error,v=a.isLoaded,E=a.submitInProgress,h=e.actualLine<e.settings.lines;return s.a.createElement("div",{className:"game"},s.a.createElement(p,{lessLine:h,playerWon:a.playerWon,error:f,isLoaded:v}),v&&s.a.createElement(L,{submitInProgress:E,submitGuess:function(){if(e.actualGuess.some((function(n){return n<0||n>e.settings.colours})))o({type:"LOADED",isLoaded:!0,error:{message:"Please fill each slot!"}});else{o({type:"SUBMITING",submitInProgress:!0});var n={id:e.id,guess:e.actualGuess};(function(e){if(!e.length||e.some((function(e){return!isFinite(e)||isNaN(e)||e>w.colours||e<0})))throw new Error("Invalid parameters");var n=O.serverless;if(!n)throw new Error("Game has not started");var t=n.secret;if(n.isOver)throw new Error("Game has already finished");var r=function(e,n,t){var r=n.reduce((function(e,n,r){return e+(n===t[r]?1:0)}),0),s=t.map((function(e,t){return{secretP:n[t],guessP:e}})).filter((function(e){return e.guessP!==e.secretP})).reduce((function(e,n){return e.secretHistogram[n.secretP]=e.secretHistogram[n.secretP]?e.secretHistogram[n.secretP]+1:1,e.guesslist.push(n.guessP),e}),{secretHistogram:{},guesslist:[]}),a=s.guesslist,o=s.secretHistogram;return{goodGuess:r,goodColour:a.reduce((function(e,n){return o[n]&&(e++,o[n]--),e}),0),playerWon:r===e.pins}}(w,t,e),s=r.goodGuess,a=r.goodColour,o=r.playerWon;n.guesses.push({guess:e,evaluation:{goodGuess:s,goodColour:a,playerWon:o}});var i=n.guesses.length>=w.lines;n.isOver=o||i;var u={goodGuess:s,goodColour:a,playerWon:o,solution:n.isOver?t:void 0};return Promise.resolve(u)})(n.guess).then((function(e){e.message?o({type:"LOADED",isLoaded:!0,error:{message:e.message}}):o({type:"NEXT_STEP",playerWon:e.playerWon,lines:m(a.lines,e),solution:e.solution?e.solution:null,error:null})}),(function(e){console.error(e),o({type:"LOADED",isLoaded:!0,error:{message:"There was an error during server request, sorry for the inconvenience :("}})})).then((function(){return o({type:"SUBMITING",submitInProgress:!1})}))}},lines:a.lines,isOver:a.playerWon||!a.playerWon&&!h,solution:a.solution,actualLine:e.actualLine}),s.a.createElement(g,null))},G=function(){return s.a.createElement("div",{className:"App"},s.a.createElement(d.Provider,{value:m},s.a.createElement(P,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[7,1,2]]]);
//# sourceMappingURL=main.f9647b95.chunk.js.map